/home/jinming/Reasoning360-MTL/verl/__init__.py:18: UserWarning: pkg_resources is deprecated as an API. See https://setuptools.pypa.io/en/latest/pkg_resources.html. The pkg_resources package is slated for removal as early as 2025-11-30. Refrain from using this package or pin to Setuptools<81.
  import pkg_resources
2025-08-05 11:48:27,572	INFO worker.py:1747 -- Connecting to existing Ray cluster at address: 10.128.9.117:6379...
2025-08-05 11:48:27,585	INFO worker.py:1918 -- Connected to Ray cluster. View the dashboard at [1m[32m10.128.9.117:8265 [39m[22m
[36m(pid=2909099)[0m /home/jinming/Reasoning360-MTL/verl/__init__.py:18: UserWarning: pkg_resources is deprecated as an API. See https://setuptools.pypa.io/en/latest/pkg_resources.html. The pkg_resources package is slated for removal as early as 2025-11-30. Refrain from using this package or pin to Setuptools<81.
[36m(pid=2909099)[0m   import pkg_resources
[36m(TaskRunner pid=2909099)[0m DeprecationWarning: `ray.state.available_resources_per_node` is a private attribute and access will be removed in a future Ray version.
[36m(TaskRunner pid=2909099)[0m WARNING:2025-08-05 11:48:47,914:Waiting for register center actor HQeVUn_register_center to be ready. Elapsed time: 0 seconds out of 300 seconds.
[36m(pid=2912202)[0m /home/jinming/Reasoning360-MTL/verl/__init__.py:18: UserWarning: pkg_resources is deprecated as an API. See https://setuptools.pypa.io/en/latest/pkg_resources.html. The pkg_resources package is slated for removal as early as 2025-11-30. Refrain from using this package or pin to Setuptools<81.
[36m(pid=2912202)[0m   import pkg_resources
[36m(pid=2912473)[0m /home/jinming/Reasoning360-MTL/verl/__init__.py:18: UserWarning: pkg_resources is deprecated as an API. See https://setuptools.pypa.io/en/latest/pkg_resources.html. The pkg_resources package is slated for removal as early as 2025-11-30. Refrain from using this package or pin to Setuptools<81.
[36m(pid=2912473)[0m   import pkg_resources
[36m(pid=2912474)[0m /home/jinming/Reasoning360-MTL/verl/__init__.py:18: UserWarning: pkg_resources is deprecated as an API. See https://setuptools.pypa.io/en/latest/pkg_resources.html. The pkg_resources package is slated for removal as early as 2025-11-30. Refrain from using this package or pin to Setuptools<81.
[36m(pid=2912474)[0m   import pkg_resources
[36m(pid=2912475)[0m /home/jinming/Reasoning360-MTL/verl/__init__.py:18: UserWarning: pkg_resources is deprecated as an API. See https://setuptools.pypa.io/en/latest/pkg_resources.html. The pkg_resources package is slated for removal as early as 2025-11-30. Refrain from using this package or pin to Setuptools<81.
[36m(pid=2912475)[0m   import pkg_resources
[36m(pid=2912476)[0m /home/jinming/Reasoning360-MTL/verl/__init__.py:18: UserWarning: pkg_resources is deprecated as an API. See https://setuptools.pypa.io/en/latest/pkg_resources.html. The pkg_resources package is slated for removal as early as 2025-11-30. Refrain from using this package or pin to Setuptools<81.
[36m(pid=2912476)[0m   import pkg_resources
[36m(pid=2912477)[0m /home/jinming/Reasoning360-MTL/verl/__init__.py:18: UserWarning: pkg_resources is deprecated as an API. See https://setuptools.pypa.io/en/latest/pkg_resources.html. The pkg_resources package is slated for removal as early as 2025-11-30. Refrain from using this package or pin to Setuptools<81.
[36m(pid=2912477)[0m   import pkg_resources
[36m(pid=2912479)[0m /home/jinming/Reasoning360-MTL/verl/__init__.py:18: UserWarning: pkg_resources is deprecated as an API. See https://setuptools.pypa.io/en/latest/pkg_resources.html. The pkg_resources package is slated for removal as early as 2025-11-30. Refrain from using this package or pin to Setuptools<81.
[36m(pid=2912479)[0m   import pkg_resources
[36m(pid=2912480)[0m /home/jinming/Reasoning360-MTL/verl/__init__.py:18: UserWarning: pkg_resources is deprecated as an API. See https://setuptools.pypa.io/en/latest/pkg_resources.html. The pkg_resources package is slated for removal as early as 2025-11-30. Refrain from using this package or pin to Setuptools<81.
[36m(pid=2912480)[0m   import pkg_resources
[36m(WorkerDict pid=2912202)[0m Sliding Window Attention is enabled but not implemented for `eager`; unexpected results may be encountered.
[36m(WorkerDict pid=2912473)[0m Sliding Window Attention is enabled but not implemented for `eager`; unexpected results may be encountered.
[36m(WorkerDict pid=2912474)[0m Sliding Window Attention is enabled but not implemented for `eager`; unexpected results may be encountered.
[36m(WorkerDict pid=2912475)[0m Sliding Window Attention is enabled but not implemented for `eager`; unexpected results may be encountered.
[36m(WorkerDict pid=2912476)[0m Sliding Window Attention is enabled but not implemented for `eager`; unexpected results may be encountered.
[36m(WorkerDict pid=2912477)[0m Sliding Window Attention is enabled but not implemented for `eager`; unexpected results may be encountered.
[36m(WorkerDict pid=2912479)[0m Sliding Window Attention is enabled but not implemented for `eager`; unexpected results may be encountered.
[36m(WorkerDict pid=2912480)[0m Sliding Window Attention is enabled but not implemented for `eager`; unexpected results may be encountered.
[36m(WorkerDict pid=2912202)[0m Loading checkpoint shards:   0%|          | 0/4 [00:00<?, ?it/s]
[36m(WorkerDict pid=2912473)[0m Loading checkpoint shards:   0%|          | 0/4 [00:00<?, ?it/s]
[36m(WorkerDict pid=2912474)[0m Loading checkpoint shards:   0%|          | 0/4 [00:00<?, ?it/s]
[36m(WorkerDict pid=2912475)[0m Loading checkpoint shards:   0%|          | 0/4 [00:00<?, ?it/s]
[36m(WorkerDict pid=2912476)[0m Loading checkpoint shards:   0%|          | 0/4 [00:00<?, ?it/s]
[36m(WorkerDict pid=2912477)[0m Loading checkpoint shards:   0%|          | 0/4 [00:00<?, ?it/s]
[36m(WorkerDict pid=2912479)[0m Loading checkpoint shards:   0%|          | 0/4 [00:00<?, ?it/s]
[36m(WorkerDict pid=2912480)[0m Loading checkpoint shards:   0%|          | 0/4 [00:00<?, ?it/s]
[36m(WorkerDict pid=2912479)[0m Loading checkpoint shards:  25%|â–ˆâ–ˆâ–Œ       | 1/4 [00:01<00:05,  1.96s/it]
[36m(WorkerDict pid=2912202)[0m Loading checkpoint shards:  25%|â–ˆâ–ˆâ–Œ       | 1/4 [00:02<00:06,  2.03s/it]
[36m(WorkerDict pid=2912476)[0m Loading checkpoint shards:  25%|â–ˆâ–ˆâ–Œ       | 1/4 [00:02<00:06,  2.05s/it]
[36m(WorkerDict pid=2912473)[0m Loading checkpoint shards:  25%|â–ˆâ–ˆâ–Œ       | 1/4 [00:02<00:07,  2.61s/it]
[36m(WorkerDict pid=2912474)[0m Loading checkpoint shards:  25%|â–ˆâ–ˆâ–Œ       | 1/4 [00:02<00:07,  2.63s/it]
[36m(WorkerDict pid=2912477)[0m Loading checkpoint shards:  25%|â–ˆâ–ˆâ–Œ       | 1/4 [00:02<00:07,  2.62s/it]
[36m(WorkerDict pid=2912475)[0m Loading checkpoint shards:  25%|â–ˆâ–ˆâ–Œ       | 1/4 [00:03<00:10,  3.36s/it]
[36m(WorkerDict pid=2912480)[0m Loading checkpoint shards:  25%|â–ˆâ–ˆâ–Œ       | 1/4 [00:03<00:10,  3.38s/it]
[36m(WorkerDict pid=2912479)[0m Loading checkpoint shards:  50%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 2/4 [00:03<00:03,  1.85s/it]
[36m(WorkerDict pid=2912202)[0m Loading checkpoint shards:  50%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 2/4 [00:03<00:03,  1.97s/it]
[36m(WorkerDict pid=2912476)[0m Loading checkpoint shards:  50%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 2/4 [00:03<00:03,  1.98s/it]
[36m(WorkerDict pid=2912473)[0m Loading checkpoint shards:  50%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 2/4 [00:05<00:05,  2.53s/it]
[36m(WorkerDict pid=2912474)[0m Loading checkpoint shards:  50%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 2/4 [00:05<00:05,  2.53s/it]
[36m(WorkerDict pid=2912477)[0m Loading checkpoint shards:  50%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 2/4 [00:05<00:05,  2.71s/it]
[36m(WorkerDict pid=2912479)[0m Loading checkpoint shards:  75%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ  | 3/4 [00:05<00:01,  1.81s/it]
[36m(WorkerDict pid=2912202)[0m Loading checkpoint shards:  75%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ  | 3/4 [00:05<00:01,  1.89s/it]
[36m(WorkerDict pid=2912476)[0m Loading checkpoint shards:  75%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ  | 3/4 [00:05<00:01,  1.88s/it]
[36m(WorkerDict pid=2912475)[0m Loading checkpoint shards:  50%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 2/4 [00:06<00:06,  3.43s/it]
[36m(WorkerDict pid=2912480)[0m Loading checkpoint shards:  50%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 2/4 [00:06<00:06,  3.42s/it]
[36m(WorkerDict pid=2912479)[0m Loading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4/4 [00:07<00:00,  1.74s/it]Loading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4/4 [00:07<00:00,  1.78s/it]
[36m(WorkerDict pid=2912476)[0m Loading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4/4 [00:07<00:00,  1.75s/it]Loading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4/4 [00:07<00:00,  1.82s/it]
[36m(WorkerDict pid=2912202)[0m Loading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4/4 [00:07<00:00,  1.77s/it]Loading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4/4 [00:07<00:00,  1.84s/it]
[36m(WorkerDict pid=2912473)[0m Loading checkpoint shards:  75%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ  | 3/4 [00:07<00:02,  2.59s/it]
[36m(WorkerDict pid=2912474)[0m Loading checkpoint shards:  75%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ  | 3/4 [00:07<00:02,  2.59s/it]
[36m(WorkerDict pid=2912477)[0m Loading checkpoint shards:  75%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ  | 3/4 [00:07<00:02,  2.63s/it]
[36m(WorkerDict pid=2912475)[0m Loading checkpoint shards:  75%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ  | 3/4 [00:09<00:03,  3.13s/it]
[36m(WorkerDict pid=2912480)[0m Loading checkpoint shards:  75%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ  | 3/4 [00:09<00:03,  3.13s/it]
[36m(WorkerDict pid=2912473)[0m Loading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4/4 [00:09<00:00,  2.44s/it]Loading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4/4 [00:09<00:00,  2.49s/it]
[36m(WorkerDict pid=2912474)[0m Loading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4/4 [00:09<00:00,  2.44s/it]Loading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4/4 [00:09<00:00,  2.49s/it]
[36m(WorkerDict pid=2912477)[0m Loading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4/4 [00:10<00:00,  2.43s/it]Loading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4/4 [00:10<00:00,  2.51s/it]
[36m(WorkerDict pid=2912475)[0m Loading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4/4 [00:11<00:00,  2.45s/it]Loading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4/4 [00:11<00:00,  2.75s/it]
[36m(WorkerDict pid=2912480)[0m Loading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4/4 [00:10<00:00,  2.44s/it]Loading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4/4 [00:10<00:00,  2.75s/it]
[36m(TaskRunner pid=2909099)[0m Training Progress:   0%|          | 0/375 [00:00<?, ?it/s]
[36m(WorkerDict pid=2912202)[0m Setting `pad_token_id` to `eos_token_id`:151643 for open-end generation.
[36m(WorkerDict pid=2912473)[0m Setting `pad_token_id` to `eos_token_id`:151643 for open-end generation.
[36m(WorkerDict pid=2912474)[0m Setting `pad_token_id` to `eos_token_id`:151643 for open-end generation.
[36m(WorkerDict pid=2912475)[0m Setting `pad_token_id` to `eos_token_id`:151643 for open-end generation.
[36m(WorkerDict pid=2912476)[0m Setting `pad_token_id` to `eos_token_id`:151643 for open-end generation.
[36m(WorkerDict pid=2912477)[0m Setting `pad_token_id` to `eos_token_id`:151643 for open-end generation.
[36m(WorkerDict pid=2912479)[0m Setting `pad_token_id` to `eos_token_id`:151643 for open-end generation.
[36m(WorkerDict pid=2912480)[0m Setting `pad_token_id` to `eos_token_id`:151643 for open-end generation.
[36m(TaskRunner pid=2909099)[0m Unhandled error (suppress with 'RAY_IGNORE_UNHANDLED_ERRORS=1'): [36mray::WorkerDict.actor_rollout_generate_sequences()[39m (pid=2912480, ip=10.128.9.117, actor_id=d90ed2800d52df1ec5bdf87301000000, repr=<verl.single_controller.ray.base.WorkerDict object at 0x1524f5602640>)
[36m(TaskRunner pid=2909099)[0m   File "/home/jinming/Reasoning360-MTL/verl/single_controller/ray/base.py", line 733, in func
[36m(TaskRunner pid=2909099)[0m     return getattr(self.worker_dict[key], name)(*args, **kwargs)
[36m(TaskRunner pid=2909099)[0m   File "/home/jinming/Reasoning360-MTL/verl/single_controller/base/decorator.py", line 680, in inner
[36m(TaskRunner pid=2909099)[0m     return func(*args, **kwargs)
[36m(TaskRunner pid=2909099)[0m   File "/home/jinming/Reasoning360-MTL/verl/workers/fsdp_workers.py", line 673, in generate_sequences
[36m(TaskRunner pid=2909099)[0m     output = self.rollout.generate_sequences(prompts=prompts)
[36m(TaskRunner pid=2909099)[0m   File "/home/jinming/Reasoning360-MTL/verl/workers/rollout/hf_rollout.py", line 49, in generate_sequences
[36m(TaskRunner pid=2909099)[0m     output = [self._generate_minibatch(p) for p in batch_prompts]
[36m(TaskRunner pid=2909099)[0m   File "/home/jinming/Reasoning360-MTL/verl/workers/rollout/hf_rollout.py", line 49, in <listcomp>
[36m(TaskRunner pid=2909099)[0m     output = [self._generate_minibatch(p) for p in batch_prompts]
[36m(TaskRunner pid=2909099)[0m   File "/home/jinming/venv_reasoning360mtl/lib64/python3.9/site-packages/torch/utils/_contextlib.py", line 116, in decorate_context
[36m(TaskRunner pid=2909099)[0m     return func(*args, **kwargs)
[36m(TaskRunner pid=2909099)[0m   File "/home/jinming/Reasoning360-MTL/verl/workers/rollout/hf_rollout.py", line 135, in _generate_minibatch
[36m(TaskRunner pid=2909099)[0m     delta_tokens = pad_token_id * delta_tokens
[36m(TaskRunner pid=2909099)[0m TypeError: unsupported operand type(s) for *: 'NoneType' and 'Tensor'
[36m(TaskRunner pid=2909099)[0m Unhandled error (suppress with 'RAY_IGNORE_UNHANDLED_ERRORS=1'): [36mray::WorkerDict.actor_rollout_generate_sequences()[39m (pid=2912476, ip=10.128.9.117, actor_id=60148f6796507d4154f7c12f01000000, repr=<verl.single_controller.ray.base.WorkerDict object at 0x1524f5602f70>)
[36m(TaskRunner pid=2909099)[0m   File "/home/jinming/Reasoning360-MTL/verl/single_controller/ray/base.py", line 733, in func
[36m(TaskRunner pid=2909099)[0m     return getattr(self.worker_dict[key], name)(*args, **kwargs)
[36m(TaskRunner pid=2909099)[0m   File "/home/jinming/Reasoning360-MTL/verl/single_controller/base/decorator.py", line 680, in inner
[36m(TaskRunner pid=2909099)[0m     return func(*args, **kwargs)
[36m(TaskRunner pid=2909099)[0m   File "/home/jinming/Reasoning360-MTL/verl/workers/fsdp_workers.py", line 673, in generate_sequences
[36m(TaskRunner pid=2909099)[0m     output = self.rollout.generate_sequences(prompts=prompts)
[36m(TaskRunner pid=2909099)[0m   File "/home/jinming/Reasoning360-MTL/verl/workers/rollout/hf_rollout.py", line 49, in generate_sequences
[36m(TaskRunner pid=2909099)[0m     output = [self._generate_minibatch(p) for p in batch_prompts]
[36m(TaskRunner pid=2909099)[0m   File "/home/jinming/Reasoning360-MTL/verl/workers/rollout/hf_rollout.py", line 49, in <listcomp>
[36m(TaskRunner pid=2909099)[0m     output = [self._generate_minibatch(p) for p in batch_prompts]
[36m(TaskRunner pid=2909099)[0m   File "/home/jinming/venv_reasoning360mtl/lib64/python3.9/site-packages/torch/utils/_contextlib.py", line 116, in decorate_context
[36m(TaskRunner pid=2909099)[0m     return func(*args, **kwargs)
[36m(TaskRunner pid=2909099)[0m   File "/home/jinming/Reasoning360-MTL/verl/workers/rollout/hf_rollout.py", line 135, in _generate_minibatch
[36m(TaskRunner pid=2909099)[0m     delta_tokens = pad_token_id * delta_tokens
[36m(TaskRunner pid=2909099)[0m TypeError: unsupported operand type(s) for *: 'NoneType' and 'Tensor'
[36m(TaskRunner pid=2909099)[0m Training Progress:   0%|          | 0/375 [00:38<?, ?it/s]Unhandled error (suppress with 'RAY_IGNORE_UNHANDLED_ERRORS=1'): [36mray::WorkerDict.actor_rollout_generate_sequences()[39m (pid=2912475, ip=10.128.9.117, actor_id=703dde6d19ba5d90676b13d501000000, repr=<verl.single_controller.ray.base.WorkerDict object at 0x1524f5602100>)
[36m(TaskRunner pid=2909099)[0m   File "/home/jinming/Reasoning360-MTL/verl/single_controller/ray/base.py", line 733, in func
[36m(TaskRunner pid=2909099)[0m     return getattr(self.worker_dict[key], name)(*args, **kwargs)
[36m(TaskRunner pid=2909099)[0m   File "/home/jinming/Reasoning360-MTL/verl/single_controller/base/decorator.py", line 680, in inner
[36m(TaskRunner pid=2909099)[0m     return func(*args, **kwargs)
[36m(TaskRunner pid=2909099)[0m   File "/home/jinming/Reasoning360-MTL/verl/workers/fsdp_workers.py", line 673, in generate_sequences
[36m(TaskRunner pid=2909099)[0m     output = self.rollout.generate_sequences(prompts=prompts)
[36m(TaskRunner pid=2909099)[0m   File "/home/jinming/Reasoning360-MTL/verl/workers/rollout/hf_rollout.py", line 49, in generate_sequences
[36m(TaskRunner pid=2909099)[0m     output = [self._generate_minibatch(p) for p in batch_prompts]
[36m(TaskRunner pid=2909099)[0m   File "/home/jinming/Reasoning360-MTL/verl/workers/rollout/hf_rollout.py", line 49, in <listcomp>
[36m(TaskRunner pid=2909099)[0m     output = [self._generate_minibatch(p) for p in batch_prompts]
[36m(TaskRunner pid=2909099)[0m   File "/home/jinming/venv_reasoning360mtl/lib64/python3.9/site-packages/torch/utils/_contextlib.py", line 116, in decorate_context
[36m(TaskRunner pid=2909099)[0m     return func(*args, **kwargs)
[36m(TaskRunner pid=2909099)[0m   File "/home/jinming/Reasoning360-MTL/verl/workers/rollout/hf_rollout.py", line 135, in _generate_minibatch
[36m(TaskRunner pid=2909099)[0m     delta_tokens = pad_token_id * delta_tokens
[36m(TaskRunner pid=2909099)[0m TypeError: unsupported operand type(s) for *: 'NoneType' and 'Tensor'
[36m(TaskRunner pid=2909099)[0m 
[36m(TaskRunner pid=2909099)[0m Unhandled error (suppress with 'RAY_IGNORE_UNHANDLED_ERRORS=1'): [36mray::WorkerDict.actor_rollout_generate_sequences()[39m (pid=2912474, ip=10.128.9.117, actor_id=0434cea7f7dfdf903d9c327801000000, repr=<verl.single_controller.ray.base.WorkerDict object at 0x1524f5602100>)
[36m(TaskRunner pid=2909099)[0m   File "/home/jinming/Reasoning360-MTL/verl/single_controller/ray/base.py", line 733, in func
[36m(TaskRunner pid=2909099)[0m     return getattr(self.worker_dict[key], name)(*args, **kwargs)
[36m(TaskRunner pid=2909099)[0m   File "/home/jinming/Reasoning360-MTL/verl/single_controller/base/decorator.py", line 680, in inner
[36m(TaskRunner pid=2909099)[0m     return func(*args, **kwargs)
[36m(TaskRunner pid=2909099)[0m   File "/home/jinming/Reasoning360-MTL/verl/workers/fsdp_workers.py", line 673, in generate_sequences
[36m(TaskRunner pid=2909099)[0m     output = self.rollout.generate_sequences(prompts=prompts)
[36m(TaskRunner pid=2909099)[0m   File "/home/jinming/Reasoning360-MTL/verl/workers/rollout/hf_rollout.py", line 49, in generate_sequences
[36m(TaskRunner pid=2909099)[0m     output = [self._generate_minibatch(p) for p in batch_prompts]
[36m(TaskRunner pid=2909099)[0m   File "/home/jinming/Reasoning360-MTL/verl/workers/rollout/hf_rollout.py", line 49, in <listcomp>
[36m(TaskRunner pid=2909099)[0m     output = [self._generate_minibatch(p) for p in batch_prompts]
[36m(TaskRunner pid=2909099)[0m   File "/home/jinming/venv_reasoning360mtl/lib64/python3.9/site-packages/torch/utils/_contextlib.py", line 116, in decorate_context
[36m(TaskRunner pid=2909099)[0m     return func(*args, **kwargs)
[36m(TaskRunner pid=2909099)[0m   File "/home/jinming/Reasoning360-MTL/verl/workers/rollout/hf_rollout.py", line 135, in _generate_minibatch
[36m(TaskRunner pid=2909099)[0m     delta_tokens = pad_token_id * delta_tokens
[36m(TaskRunner pid=2909099)[0m TypeError: unsupported operand type(s) for *: 'NoneType' and 'Tensor'
[36m(TaskRunner pid=2909099)[0m Unhandled error (suppress with 'RAY_IGNORE_UNHANDLED_ERRORS=1'): [36mray::WorkerDict.actor_rollout_generate_sequences()[39m (pid=2912473, ip=10.128.9.117, actor_id=8b6a388d6b38b7016c9c816001000000, repr=<verl.single_controller.ray.base.WorkerDict object at 0x1524f55fd160>)
[36m(TaskRunner pid=2909099)[0m   File "/home/jinming/Reasoning360-MTL/verl/single_controller/ray/base.py", line 733, in func
[36m(TaskRunner pid=2909099)[0m     return getattr(self.worker_dict[key], name)(*args, **kwargs)
[36m(TaskRunner pid=2909099)[0m   File "/home/jinming/Reasoning360-MTL/verl/single_controller/base/decorator.py", line 680, in inner
[36m(TaskRunner pid=2909099)[0m     return func(*args, **kwargs)
[36m(TaskRunner pid=2909099)[0m   File "/home/jinming/Reasoning360-MTL/verl/workers/fsdp_workers.py", line 673, in generate_sequences
[36m(TaskRunner pid=2909099)[0m     output = self.rollout.generate_sequences(prompts=prompts)
[36m(TaskRunner pid=2909099)[0m   File "/home/jinming/Reasoning360-MTL/verl/workers/rollout/hf_rollout.py", line 49, in generate_sequences
[36m(TaskRunner pid=2909099)[0m     output = [self._generate_minibatch(p) for p in batch_prompts]
[36m(TaskRunner pid=2909099)[0m   File "/home/jinming/Reasoning360-MTL/verl/workers/rollout/hf_rollout.py", line 49, in <listcomp>
[36m(TaskRunner pid=2909099)[0m     output = [self._generate_minibatch(p) for p in batch_prompts]
[36m(TaskRunner pid=2909099)[0m   File "/home/jinming/venv_reasoning360mtl/lib64/python3.9/site-packages/torch/utils/_contextlib.py", line 116, in decorate_context
[36m(TaskRunner pid=2909099)[0m     return func(*args, **kwargs)
[36m(TaskRunner pid=2909099)[0m   File "/home/jinming/Reasoning360-MTL/verl/workers/rollout/hf_rollout.py", line 135, in _generate_minibatch
[36m(TaskRunner pid=2909099)[0m     delta_tokens = pad_token_id * delta_tokens
[36m(TaskRunner pid=2909099)[0m TypeError: unsupported operand type(s) for *: 'NoneType' and 'Tensor'
[36m(TaskRunner pid=2909099)[0m Unhandled error (suppress with 'RAY_IGNORE_UNHANDLED_ERRORS=1'): [36mray::WorkerDict.actor_rollout_generate_sequences()[39m (pid=2912202, ip=10.128.9.117, actor_id=d1a994a0cac76620e0f5300f01000000, repr=<verl.single_controller.ray.base.WorkerDict object at 0x1524715e0160>)
[36m(TaskRunner pid=2909099)[0m   File "/home/jinming/Reasoning360-MTL/verl/single_controller/ray/base.py", line 733, in func
[36m(TaskRunner pid=2909099)[0m     return getattr(self.worker_dict[key], name)(*args, **kwargs)
[36m(TaskRunner pid=2909099)[0m   File "/home/jinming/Reasoning360-MTL/verl/single_controller/base/decorator.py", line 680, in inner
[36m(TaskRunner pid=2909099)[0m     return func(*args, **kwargs)
[36m(TaskRunner pid=2909099)[0m   File "/home/jinming/Reasoning360-MTL/verl/workers/fsdp_workers.py", line 673, in generate_sequences
[36m(TaskRunner pid=2909099)[0m     output = self.rollout.generate_sequences(prompts=prompts)
[36m(TaskRunner pid=2909099)[0m   File "/home/jinming/Reasoning360-MTL/verl/workers/rollout/hf_rollout.py", line 49, in generate_sequences
[36m(TaskRunner pid=2909099)[0m     output = [self._generate_minibatch(p) for p in batch_prompts]
[36m(TaskRunner pid=2909099)[0m   File "/home/jinming/Reasoning360-MTL/verl/workers/rollout/hf_rollout.py", line 49, in <listcomp>
[36m(TaskRunner pid=2909099)[0m     output = [self._generate_minibatch(p) for p in batch_prompts]
[36m(TaskRunner pid=2909099)[0m   File "/home/jinming/venv_reasoning360mtl/lib64/python3.9/site-packages/torch/utils/_contextlib.py", line 116, in decorate_context
[36m(TaskRunner pid=2909099)[0m     return func(*args, **kwargs)
[36m(TaskRunner pid=2909099)[0m   File "/home/jinming/Reasoning360-MTL/verl/workers/rollout/hf_rollout.py", line 135, in _generate_minibatch
[36m(TaskRunner pid=2909099)[0m     delta_tokens = pad_token_id * delta_tokens
[36m(TaskRunner pid=2909099)[0m TypeError: unsupported operand type(s) for *: 'NoneType' and 'Tensor'
Error executing job with overrides: ['data.train_files=/home/jinming/Reasoning360-MTL/data/train/guru_18k/math.parquet', 'data.val_files=/home/jinming/Reasoning360-MTL/data/train/guru_18k/math.parquet', 'data.tokenizer=/home/jinming/llm_models/Qwen2.5-7B', 'data.max_prompt_length=256', 'data.max_response_length=512', 'data.train_batch_size=8', 'data.gen_batch_size=8', 'actor_rollout_ref.model.path=/home/jinming/llm_models/Qwen2.5-7B', 'actor_rollout_ref.actor.ppo_mini_batch_size=8', 'actor_rollout_ref.actor.ppo_micro_batch_size_per_gpu=1', 'actor_rollout_ref.ref.log_prob_micro_batch_size_per_gpu=1', 'actor_rollout_ref.rollout.log_prob_micro_batch_size_per_gpu=1', 'actor_rollout_ref.rollout.n=1', 'actor_rollout_ref.rollout.name=hf', '++actor_rollout_ref.rollout.tensor_parallel_size=2', '++actor_rollout_ref.rollout.model_hf_config.attn_implementation=eager', '++actor_rollout_ref.rollout.model_hf_config.torch_dtype=bfloat16', '++actor_rollout_ref.rollout.model_hf_config.use_cache=false', '++actor_rollout_ref.rollout.model_hf_config.trust_remote_code=true', '++actor_rollout_ref.rollout.generation_config.do_sample=true', '++actor_rollout_ref.rollout.generation_config.temperature=0.7', '++actor_rollout_ref.rollout.generation_config.top_p=0.9', '++actor_rollout_ref.rollout.generation_config.max_new_tokens=512', '++actor_rollout_ref.rollout.generation_config.pad_token_id=151643', '++actor_rollout_ref.rollout.pad_token_id=151643', 'actor_rollout_ref.rollout.temperature=1.0', 'actor_rollout_ref.rollout.top_p=1.0', 'actor_rollout_ref.rollout.top_k=-1', 'trainer.nnodes=1', 'trainer.n_gpus_per_node=8', 'trainer.total_epochs=1', 'trainer.val_before_train=false', 'trainer.test_freq=0', 'trainer.save_freq=-1', 'trainer.project_name=hf_rollout_test', 'trainer.logger=[console]', 'algorithm.adv_estimator=grpo']
Traceback (most recent call last):
  File "/home/jinming/Reasoning360-MTL/verl/trainer/main_ppo.py", line 27, in main
    run_ppo(config)
  File "/home/jinming/Reasoning360-MTL/verl/trainer/main_ppo.py", line 39, in run_ppo
    ray.get(runner.run.remote(config))
  File "/home/jinming/venv_reasoning360mtl/lib64/python3.9/site-packages/ray/_private/auto_init_hook.py", line 22, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/home/jinming/venv_reasoning360mtl/lib64/python3.9/site-packages/ray/_private/client_mode_hook.py", line 104, in wrapper
    return func(*args, **kwargs)
  File "/home/jinming/venv_reasoning360mtl/lib64/python3.9/site-packages/ray/_private/worker.py", line 2858, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/home/jinming/venv_reasoning360mtl/lib64/python3.9/site-packages/ray/_private/worker.py", line 958, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(TypeError): [36mray::TaskRunner.run()[39m (pid=2909099, ip=10.128.9.117, actor_id=271aef421bdc5dbf47b45bfd01000000, repr=<main_ppo.TaskRunner object at 0x15250709ddc0>)
  File "/home/jinming/Reasoning360-MTL/verl/trainer/main_ppo.py", line 155, in run
    trainer.fit()
  File "/home/jinming/Reasoning360-MTL/verl/trainer/ppo/ray_trainer.py", line 1079, in fit
    batch = self._process_batch(gen_batch.union(batch))
  File "/home/jinming/Reasoning360-MTL/verl/trainer/ppo/ray_trainer.py", line 854, in _process_batch
    gen_batch_output = self.actor_rollout_wg.generate_sequences(batch)
  File "/home/jinming/Reasoning360-MTL/verl/single_controller/ray/base.py", line 51, in __call__
    output = ray.get(output)
ray.exceptions.RayTaskError(TypeError): [36mray::WorkerDict.actor_rollout_generate_sequences()[39m (pid=2912479, ip=10.128.9.117, actor_id=d0c5e742d09a520d06304a5301000000, repr=<verl.single_controller.ray.base.WorkerDict object at 0x1524f5602fd0>)
  File "/home/jinming/Reasoning360-MTL/verl/single_controller/ray/base.py", line 733, in func
    return getattr(self.worker_dict[key], name)(*args, **kwargs)
  File "/home/jinming/Reasoning360-MTL/verl/single_controller/base/decorator.py", line 680, in inner
    return func(*args, **kwargs)
  File "/home/jinming/Reasoning360-MTL/verl/workers/fsdp_workers.py", line 673, in generate_sequences
    output = self.rollout.generate_sequences(prompts=prompts)
  File "/home/jinming/Reasoning360-MTL/verl/workers/rollout/hf_rollout.py", line 49, in generate_sequences
    output = [self._generate_minibatch(p) for p in batch_prompts]
  File "/home/jinming/Reasoning360-MTL/verl/workers/rollout/hf_rollout.py", line 49, in <listcomp>
    output = [self._generate_minibatch(p) for p in batch_prompts]
  File "/home/jinming/venv_reasoning360mtl/lib64/python3.9/site-packages/torch/utils/_contextlib.py", line 116, in decorate_context
    return func(*args, **kwargs)
  File "/home/jinming/Reasoning360-MTL/verl/workers/rollout/hf_rollout.py", line 135, in _generate_minibatch
    delta_tokens = pad_token_id * delta_tokens
TypeError: unsupported operand type(s) for *: 'NoneType' and 'Tensor'

Set the environment variable HYDRA_FULL_ERROR=1 for a complete stack trace.
