/home/jinming/Reasoning360-MTL/verl/__init__.py:18: UserWarning: pkg_resources is deprecated as an API. See https://setuptools.pypa.io/en/latest/pkg_resources.html. The pkg_resources package is slated for removal as early as 2025-11-30. Refrain from using this package or pin to Setuptools<81.
  import pkg_resources
2025-08-05 08:34:43,538	INFO worker.py:1747 -- Connecting to existing Ray cluster at address: 10.128.9.112:6379...
2025-08-05 08:34:43,549	INFO worker.py:1927 -- Connected to Ray cluster.
[36m(pid=1609500)[0m /home/jinming/Reasoning360-MTL/verl/__init__.py:18: UserWarning: pkg_resources is deprecated as an API. See https://setuptools.pypa.io/en/latest/pkg_resources.html. The pkg_resources package is slated for removal as early as 2025-11-30. Refrain from using this package or pin to Setuptools<81.
[36m(pid=1609500)[0m   import pkg_resources
[36m(TaskRunner pid=1609500)[0m /home/jinming/venv_reasoning360mtl/lib64/python3.9/site-packages/torch/utils/data/dataloader.py:624: UserWarning: This DataLoader will create 8 worker processes in total. Our suggested max number of worker in current system is 4, which is smaller than what this DataLoader is going to create. Please be aware that excessive worker creation might get DataLoader running slow or even freeze, lower the worker number to avoid potential slowness/freeze if necessary.
[36m(TaskRunner pid=1609500)[0m   warnings.warn(
[36m(TaskRunner pid=1609500)[0m DeprecationWarning: `ray.state.available_resources_per_node` is a private attribute and access will be removed in a future Ray version.
[36m(TaskRunner pid=1609500)[0m WARNING:2025-08-05 08:35:03,783:Waiting for register center actor Rl5WoU_register_center to be ready. Elapsed time: 0 seconds out of 300 seconds.
[36m(pid=1610145)[0m /home/jinming/Reasoning360-MTL/verl/__init__.py:18: UserWarning: pkg_resources is deprecated as an API. See https://setuptools.pypa.io/en/latest/pkg_resources.html. The pkg_resources package is slated for removal as early as 2025-11-30. Refrain from using this package or pin to Setuptools<81.
[36m(pid=1610145)[0m   import pkg_resources
[36m(pid=1611929)[0m /home/jinming/Reasoning360-MTL/verl/__init__.py:18: UserWarning: pkg_resources is deprecated as an API. See https://setuptools.pypa.io/en/latest/pkg_resources.html. The pkg_resources package is slated for removal as early as 2025-11-30. Refrain from using this package or pin to Setuptools<81.
[36m(pid=1611929)[0m   import pkg_resources
[36m(WorkerDict pid=1611929)[0m Sliding Window Attention is enabled but not implemented for `eager`; unexpected results may be encountered.
[36m(WorkerDict pid=1611929)[0m Loading checkpoint shards:   0%|          | 0/4 [00:00<?, ?it/s]
[36m(WorkerDict pid=1611929)[0m Loading checkpoint shards:  25%|â–ˆâ–ˆâ–Œ       | 1/4 [00:01<00:03,  1.15s/it]
[36m(WorkerDict pid=1611929)[0m Loading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4/4 [00:04<00:00,  1.07s/it]Loading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4/4 [00:04<00:00,  1.09s/it]
Error executing job with overrides: ['algorithm.adv_estimator=grpo', 'data.train_files=[/home/jinming/Reasoning360-MTL/data/train/guru_18k/math.parquet]', 'data.val_files=[/home/jinming/Reasoning360-MTL/data/validation/guru_3k/math.parquet]', 'data.tokenizer=/home/jinming/llm_models/Qwen2.5-7B', 'data.max_prompt_length=512', 'data.max_response_length=1024', 'data.train_batch_size=2', 'data.gen_batch_size=2', 'actor_rollout_ref.model.path=/home/jinming/llm_models/Qwen2.5-7B', 'critic.model.path=/home/jinming/llm_models/Qwen2.5-7B', 'actor_rollout_ref.actor.ppo_mini_batch_size=2', 'actor_rollout_ref.actor.ppo_micro_batch_size_per_gpu=1', 'critic.ppo_micro_batch_size_per_gpu=1', 'actor_rollout_ref.ref.log_prob_micro_batch_size_per_gpu=1', 'actor_rollout_ref.rollout.log_prob_micro_batch_size_per_gpu=1', 'actor_rollout_ref.rollout.n=1', 'actor_rollout_ref.rollout.name=vllm', 'actor_rollout_ref.rollout.gpu_memory_utilization=0.4', '++actor_rollout_ref.rollout.max_model_len=1024', '++actor_rollout_ref.rollout.max_num_seqs=2', '++actor_rollout_ref.rollout.enforce_eager=true', 'actor_rollout_ref.rollout.temperature=1.0', 'actor_rollout_ref.rollout.top_p=1.0', 'actor_rollout_ref.rollout.top_k=-1', 'actor_rollout_ref.rollout.val_kwargs.top_k=-1', 'actor_rollout_ref.rollout.val_kwargs.top_p=1.0', 'actor_rollout_ref.rollout.val_kwargs.temperature=1.0', 'actor_rollout_ref.rollout.val_kwargs.n=1', 'actor_rollout_ref.rollout.val_kwargs.do_sample=True', 'actor_rollout_ref.model.use_remove_padding=False', 'actor_rollout_ref.model.enable_gradient_checkpointing=True', 'actor_rollout_ref.actor.strategy=fsdp', 'actor_rollout_ref.actor.optim.lr=1e-6', 'actor_rollout_ref.actor.optim.lr_warmup_steps=10', 'actor_rollout_ref.actor.optim.weight_decay=0.1', 'actor_rollout_ref.actor.optim.warmup_style=constant', 'actor_rollout_ref.actor.optim.min_lr_ratio=0.0', 'actor_rollout_ref.actor.clip_ratio_low=0.2', 'actor_rollout_ref.actor.clip_ratio_high=0.2', 'actor_rollout_ref.actor.clip_ratio_c=10.0', 'actor_rollout_ref.actor.entropy_coeff=0', 'actor_rollout_ref.actor.grad_clip=1.0', 'actor_rollout_ref.actor.fsdp_config.param_offload=true', 'actor_rollout_ref.actor.fsdp_config.optimizer_offload=true', '++actor_rollout_ref.actor.fsdp_config.activation_offload=true', '++critic.fsdp_config.param_offload=true', '++critic.fsdp_config.optimizer_offload=true', 'trainer.nnodes=1', 'trainer.n_gpus_per_node=2', 'trainer.total_epochs=30', 'trainer.val_before_train=false', 'trainer.test_freq=3', 'trainer.save_freq=5', 'trainer.logger=[console,wandb]', 'trainer.project_name=Reasoning360-MTL', 'trainer.experiment_name=2gpu-baseline-3274507', '++trainer.ray_wait_register_center_timeout=300', '++actor_rollout_ref.model.enable_flash_attention=false', '++critic.model.enable_flash_attention=false', '++actor_rollout_ref.model.enable_gradient_checkpointing=true', '++critic.model.enable_gradient_checkpointing=true', '++actor_rollout_ref.model.enable_activation_offload=true', '++critic.model.enable_activation_offload=true', '++actor_rollout_ref.actor.entropy_checkpointing=true', '++actor_rollout_ref.ref.entropy_from_logits_with_chunking=true', '++actor_rollout_ref.rollout.multi_turn.enable=false', '++actor_rollout_ref.rollout.mode=sync', '+trainer.early_stopping_min_epochs=10', '+trainer.early_stopping_patience=3', '+trainer.early_stopping_min_delta=0.001', '+trainer.early_stopping_metric=validation_reward_mean', '+trainer.early_stopping_mode=max', 'mtl.enabled=false', 'mtl.method=pcgrad']
Traceback (most recent call last):
  File "/home/jinming/Reasoning360-MTL/verl/trainer/main_ppo.py", line 27, in main
    run_ppo(config)
  File "/home/jinming/Reasoning360-MTL/verl/trainer/main_ppo.py", line 39, in run_ppo
    ray.get(runner.run.remote(config))
  File "/home/jinming/venv_reasoning360mtl/lib64/python3.9/site-packages/ray/_private/auto_init_hook.py", line 22, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/home/jinming/venv_reasoning360mtl/lib64/python3.9/site-packages/ray/_private/client_mode_hook.py", line 104, in wrapper
    return func(*args, **kwargs)
  File "/home/jinming/venv_reasoning360mtl/lib64/python3.9/site-packages/ray/_private/worker.py", line 2858, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/home/jinming/venv_reasoning360mtl/lib64/python3.9/site-packages/ray/_private/worker.py", line 958, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(RuntimeError): [36mray::TaskRunner.run()[39m (pid=1609500, ip=10.128.9.112, actor_id=63f47701352119463884643701000000, repr=<main_ppo.TaskRunner object at 0x152507102c40>)
  File "/home/jinming/Reasoning360-MTL/verl/trainer/main_ppo.py", line 154, in run
    trainer.init_workers()
  File "/home/jinming/Reasoning360-MTL/verl/trainer/ppo/ray_trainer.py", line 736, in init_workers
    self.actor_rollout_wg.init_model()
  File "/home/jinming/Reasoning360-MTL/verl/single_controller/ray/base.py", line 51, in __call__
    output = ray.get(output)
ray.exceptions.RayTaskError(RuntimeError): [36mray::WorkerDict.actor_rollout_init_model()[39m (pid=1611929, ip=10.128.9.112, actor_id=8a87f8427edee9c8f4edebdd01000000, repr=<verl.single_controller.ray.base.WorkerDict object at 0x1524f5661880>)
  File "/home/jinming/Reasoning360-MTL/verl/single_controller/ray/base.py", line 733, in func
    return getattr(self.worker_dict[key], name)(*args, **kwargs)
  File "/home/jinming/Reasoning360-MTL/verl/single_controller/base/decorator.py", line 680, in inner
    return func(*args, **kwargs)
  File "/home/jinming/Reasoning360-MTL/verl/workers/fsdp_workers.py", line 519, in init_model
    ) = self._build_model_optimizer(
  File "/home/jinming/Reasoning360-MTL/verl/workers/fsdp_workers.py", line 274, in _build_model_optimizer
    torch.distributed.barrier()
  File "/home/jinming/venv_reasoning360mtl/lib64/python3.9/site-packages/torch/distributed/c10d_logger.py", line 81, in wrapper
    return func(*args, **kwargs)
  File "/home/jinming/venv_reasoning360mtl/lib64/python3.9/site-packages/torch/distributed/distributed_c10d.py", line 4556, in barrier
    work.wait()
RuntimeError: [/pytorch/third_party/gloo/gloo/transport/tcp/pair.cc:534] Connection closed by peer [10.128.9.112]:6070

Set the environment variable HYDRA_FULL_ERROR=1 for a complete stack trace.
[36m(WorkerDict pid=1610145)[0m Sliding Window Attention is enabled but not implemented for `eager`; unexpected results may be encountered.
[36m(WorkerDict pid=1610145)[0m Loading checkpoint shards:   0%|          | 0/4 [00:00<?, ?it/s]
[36m(WorkerDict pid=1610145)[0m Loading checkpoint shards:  75%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ  | 3/4 [00:03<00:01,  1.24s/it][32m [repeated 5x across cluster] (Ray deduplicates logs by default. Set RAY_DEDUP_LOGS=0 to disable log deduplication, or see https://docs.ray.io/en/master/ray-observability/user-guides/configure-logging.html#log-deduplication for more options.)[0m
slurmstepd: error: Detected 1 oom_kill event in StepId=3274507.batch. Some of the step tasks have been OOM Killed.
