/home/jinming/Reasoning360-MTL/verl/__init__.py:18: UserWarning: pkg_resources is deprecated as an API. See https://setuptools.pypa.io/en/latest/pkg_resources.html. The pkg_resources package is slated for removal as early as 2025-11-30. Refrain from using this package or pin to Setuptools<81.
  import pkg_resources
2025-08-05 09:39:45,947	INFO worker.py:1747 -- Connecting to existing Ray cluster at address: 10.128.9.112:6379...
2025-08-05 09:39:45,958	INFO worker.py:1927 -- Connected to Ray cluster.
[36m(pid=1823899)[0m /home/jinming/Reasoning360-MTL/verl/__init__.py:18: UserWarning: pkg_resources is deprecated as an API. See https://setuptools.pypa.io/en/latest/pkg_resources.html. The pkg_resources package is slated for removal as early as 2025-11-30. Refrain from using this package or pin to Setuptools<81.
[36m(pid=1823899)[0m   import pkg_resources
[36m(TaskRunner pid=1823899)[0m /home/jinming/venv_reasoning360mtl/lib64/python3.9/site-packages/torch/utils/data/dataloader.py:624: UserWarning: This DataLoader will create 8 worker processes in total. Our suggested max number of worker in current system is 4, which is smaller than what this DataLoader is going to create. Please be aware that excessive worker creation might get DataLoader running slow or even freeze, lower the worker number to avoid potential slowness/freeze if necessary.
[36m(TaskRunner pid=1823899)[0m   warnings.warn(
[36m(TaskRunner pid=1823899)[0m DeprecationWarning: `ray.state.available_resources_per_node` is a private attribute and access will be removed in a future Ray version.
[36m(TaskRunner pid=1823899)[0m WARNING:2025-08-05 09:40:07,622:Waiting for register center actor XX23sy_register_center to be ready. Elapsed time: 0 seconds out of 300 seconds.
[36m(pid=1825869)[0m /home/jinming/Reasoning360-MTL/verl/__init__.py:18: UserWarning: pkg_resources is deprecated as an API. See https://setuptools.pypa.io/en/latest/pkg_resources.html. The pkg_resources package is slated for removal as early as 2025-11-30. Refrain from using this package or pin to Setuptools<81.
[36m(pid=1825869)[0m   import pkg_resources
[36m(pid=1826370)[0m /home/jinming/Reasoning360-MTL/verl/__init__.py:18: UserWarning: pkg_resources is deprecated as an API. See https://setuptools.pypa.io/en/latest/pkg_resources.html. The pkg_resources package is slated for removal as early as 2025-11-30. Refrain from using this package or pin to Setuptools<81.
[36m(pid=1826370)[0m   import pkg_resources
[36m(pid=1826373)[0m /home/jinming/Reasoning360-MTL/verl/__init__.py:18: UserWarning: pkg_resources is deprecated as an API. See https://setuptools.pypa.io/en/latest/pkg_resources.html. The pkg_resources package is slated for removal as early as 2025-11-30. Refrain from using this package or pin to Setuptools<81.
[36m(pid=1826373)[0m   import pkg_resources
[36m(WorkerDict pid=1825869)[0m Sliding Window Attention is enabled but not implemented for `eager`; unexpected results may be encountered.
[36m(WorkerDict pid=1825869)[0m Loading checkpoint shards:   0%|          | 0/4 [00:00<?, ?it/s]
[36m(pid=1826371)[0m /home/jinming/Reasoning360-MTL/verl/__init__.py:18: UserWarning: pkg_resources is deprecated as an API. See https://setuptools.pypa.io/en/latest/pkg_resources.html. The pkg_resources package is slated for removal as early as 2025-11-30. Refrain from using this package or pin to Setuptools<81.
[36m(pid=1826371)[0m   import pkg_resources
[36m(WorkerDict pid=1825869)[0m Loading checkpoint shards:  25%|â–ˆâ–ˆâ–Œ       | 1/4 [00:01<00:04,  1.48s/it]
[36m(WorkerDict pid=1826371)[0m Sliding Window Attention is enabled but not implemented for `eager`; unexpected results may be encountered.[32m [repeated 3x across cluster][0m
[36m(WorkerDict pid=1826371)[0m Loading checkpoint shards:   0%|          | 0/4 [00:00<?, ?it/s][32m [repeated 3x across cluster][0m
Error executing job with overrides: ['algorithm.adv_estimator=grpo', 'data.train_files=[/home/jinming/Reasoning360-MTL/data/train/guru_18k/math.parquet]', 'data.val_files=[/home/jinming/Reasoning360-MTL/data/validation/guru_3k/math.parquet]', 'data.tokenizer=/home/jinming/llm_models/Qwen2.5-7B', 'data.max_prompt_length=512', 'data.max_response_length=1024', 'data.train_batch_size=4', 'data.gen_batch_size=4', 'actor_rollout_ref.model.path=/home/jinming/llm_models/Qwen2.5-7B', 'critic.model.path=/home/jinming/llm_models/Qwen2.5-7B', 'actor_rollout_ref.actor.ppo_mini_batch_size=4', 'actor_rollout_ref.actor.ppo_micro_batch_size_per_gpu=1', 'critic.ppo_micro_batch_size_per_gpu=1', 'actor_rollout_ref.ref.log_prob_micro_batch_size_per_gpu=1', 'actor_rollout_ref.rollout.log_prob_micro_batch_size_per_gpu=1', 'actor_rollout_ref.rollout.n=1', 'actor_rollout_ref.rollout.name=vllm', 'actor_rollout_ref.rollout.gpu_memory_utilization=0.2', '++actor_rollout_ref.rollout.max_model_len=512', '++actor_rollout_ref.rollout.max_num_seqs=1', '++actor_rollout_ref.rollout.enforce_eager=true', '++actor_rollout_ref.rollout.tensor_parallel_size=2', 'actor_rollout_ref.rollout.temperature=1.0', 'actor_rollout_ref.rollout.top_p=1.0', 'actor_rollout_ref.rollout.top_k=-1', 'actor_rollout_ref.rollout.val_kwargs.top_k=-1', 'actor_rollout_ref.rollout.val_kwargs.top_p=1.0', 'actor_rollout_ref.rollout.val_kwargs.temperature=1.0', 'actor_rollout_ref.rollout.val_kwargs.n=1', 'actor_rollout_ref.rollout.val_kwargs.do_sample=True', 'actor_rollout_ref.model.use_remove_padding=False', 'actor_rollout_ref.model.enable_gradient_checkpointing=True', 'actor_rollout_ref.actor.strategy=fsdp', 'actor_rollout_ref.actor.optim.lr=1e-6', 'actor_rollout_ref.actor.optim.lr_warmup_steps=10', 'actor_rollout_ref.actor.optim.weight_decay=0.1', 'actor_rollout_ref.actor.optim.warmup_style=constant', 'actor_rollout_ref.actor.optim.min_lr_ratio=0.0', 'actor_rollout_ref.actor.clip_ratio_low=0.2', 'actor_rollout_ref.actor.clip_ratio_high=0.2', 'actor_rollout_ref.actor.clip_ratio_c=10.0', 'actor_rollout_ref.actor.entropy_coeff=0', 'actor_rollout_ref.actor.grad_clip=1.0', 'actor_rollout_ref.actor.fsdp_config.param_offload=true', 'actor_rollout_ref.actor.fsdp_config.optimizer_offload=true', '++actor_rollout_ref.actor.fsdp_config.activation_offload=true', '++critic.fsdp_config.param_offload=true', '++critic.fsdp_config.optimizer_offload=true', 'trainer.nnodes=1', 'trainer.n_gpus_per_node=4', 'trainer.total_epochs=30', 'trainer.val_before_train=false', 'trainer.test_freq=3', 'trainer.save_freq=5', 'trainer.logger=[console]', 'trainer.project_name=Reasoning360-MTL', 'algorithm.adv_estimator=grpo', 'trainer.experiment_name=2gpu-baseline-3274552', '++trainer.ray_wait_register_center_timeout=300', '++actor_rollout_ref.model.enable_flash_attention=false', '++actor_rollout_ref.model.enable_gradient_checkpointing=true', '++actor_rollout_ref.model.enable_activation_offload=true', '++actor_rollout_ref.actor.entropy_checkpointing=true', '++actor_rollout_ref.ref.entropy_from_logits_with_chunking=true', '++actor_rollout_ref.rollout.multi_turn.enable=false', '++actor_rollout_ref.rollout.mode=sync', '+trainer.early_stopping_min_epochs=10', '+trainer.early_stopping_patience=3', '+trainer.early_stopping_min_delta=0.001', '+trainer.early_stopping_metric=validation_reward_mean', '+trainer.early_stopping_mode=max', 'mtl.enabled=false', 'mtl.method=pcgrad']
Traceback (most recent call last):
  File "/home/jinming/Reasoning360-MTL/verl/trainer/main_ppo.py", line 27, in main
    run_ppo(config)
  File "/home/jinming/Reasoning360-MTL/verl/trainer/main_ppo.py", line 39, in run_ppo
    ray.get(runner.run.remote(config))
  File "/home/jinming/venv_reasoning360mtl/lib64/python3.9/site-packages/ray/_private/auto_init_hook.py", line 22, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/home/jinming/venv_reasoning360mtl/lib64/python3.9/site-packages/ray/_private/client_mode_hook.py", line 104, in wrapper
    return func(*args, **kwargs)
  File "/home/jinming/venv_reasoning360mtl/lib64/python3.9/site-packages/ray/_private/worker.py", line 2858, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/home/jinming/venv_reasoning360mtl/lib64/python3.9/site-packages/ray/_private/worker.py", line 958, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ActorDiedError): [36mray::TaskRunner.run()[39m (pid=1823899, ip=10.128.9.112, actor_id=8663c09110dd955432166b2401000000, repr=<main_ppo.TaskRunner object at 0x154c9bd8bb80>)
  File "/home/jinming/Reasoning360-MTL/verl/trainer/main_ppo.py", line 154, in run
    trainer.init_workers()
  File "/home/jinming/Reasoning360-MTL/verl/trainer/ppo/ray_trainer.py", line 736, in init_workers
    self.actor_rollout_wg.init_model()
  File "/home/jinming/Reasoning360-MTL/verl/single_controller/ray/base.py", line 51, in __call__
    output = ray.get(output)
ray.exceptions.ActorDiedError: The actor died unexpectedly before finishing this task.
	class_name: create_colocated_worker_cls.<locals>.WorkerDict
	actor_id: c629d3cf1ddfc9ecbd988dae01000000
	pid: 1825869
	name: XX23syWorkerDict_0:0
	namespace: 29bf5d3a-81cd-44b5-9b78-b50e8604e506
	ip: 10.128.9.112
The actor is dead because its worker process has died. Worker exit type: SYSTEM_ERROR Worker exit detail: Worker unexpectedly exits with a connection error code 2. End of file. There are some potential root causes. (1) The process is killed by SIGKILL by OOM killer due to high memory usage. (2) ray stop --force is called. (3) The worker is crashed unexpectedly due to SIGSEGV or other unexpected errors.

Set the environment variable HYDRA_FULL_ERROR=1 for a complete stack trace.
[36m(WorkerDict pid=1826373)[0m Loading checkpoint shards:  75%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ  | 3/4 [00:06<00:01,  1.96s/it][32m [repeated 11x across cluster][0m
slurmstepd: error: Detected 1 oom_kill event in StepId=3274552.batch. Some of the step tasks have been OOM Killed.
